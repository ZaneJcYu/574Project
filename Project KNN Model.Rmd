---
title: "Project Work"
author: "Carson Barningham"
date: "2023-11-27"
output: pdf_document
---

```{r}
library(MASS)
library(class)
train = read.csv('train_and_test.csv')
```

```{r}
# k = 6 gives the lowest CV error
set.seed(1)
train$Partition = sample(factor(rep(1:10, length.out=nrow(train)), labels = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)))
for (k_val in 1:10) {
  test_errors = c()
  for (i in 1:10) {
    set.seed(1)
    temp_train = subset(train, !(Partition %in% c(i)))
    temp_test = subset(train, (Partition %in% c(i)))
    knn = knn(temp_train[,-1], temp_test[,-1], temp_train$X, k = k_val)
    test_error = mean(temp_test$X != knn)
    test_errors = append(test_errors, test_error)
  }
  print(sprintf("k: %f, 10-fold CV error: %f", k_val, mean(test_errors)))
}

```

```{r}
set.seed(1)
knn = knn(train[,-1], train[,-1], train$X, k = 6)
table(train$X, knn)
```